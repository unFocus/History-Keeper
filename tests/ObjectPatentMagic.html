<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<title>Object Patent Magic</title>
<!--
unFocus.Tests (2007/07/21)
Copyright: 2007, Kevin Newman (http://www.unfocus.com/Projects/)

This file is part of unFocus.History Keeper.

unFocus.History Keeper is free software; you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by
the Free Software Foundation; either version 3 of the License, or (at your option) any later version.

unFocus.History Keeper is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU Lesser General Public License for more details.

You should have received a copy of the GNU Lesser General Public License along with this program.  If not, see <http://www.gnu.org/licenses/>.
-->
<!--[if gte IE 6]>
<style type="text/css" id="ObjectPatentMagic">object{display:none}</style>
<script type="text/javascript" src="../javascript/ObjectPatentMagic-p.js" defer></script>
<![endif]-->
</head>

<body>
<strong>Note:</strong> This embeded active x control (flash) should not need activation in IE (the bookmarking/history stuff is not enabled in this example).
<p>
<!--[if IE]>
<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=7,0,19,0" width="320" height="240">
<param name="allowScriptAccess" value="sameDomain" />
<param name="movie" value="rotateTool.swf" />
<param name="quality" value="high" />
<param name="scale" value="noscale" />
<param name="salign" value="lt" />
<param name="bgcolor" value="#ffffff" />
<param name="flashvars" value="path=objects/plane/" />
</object>
<![endif]-->
<!--[if !IE]> <-->
<object data="rotateTool.swf" type="application/x-shockwave-flash" width="320" height="240">
<param name="allowScriptAccess" value="sameDomain" />
<param name="movie" value="rotateTool.swf" />
<param name="quality" value="high" />
<param name="scale" value="noscale" />
<param name="salign" value="lt" />
<param name="bgcolor" value="#ffffff" />
<param name="flashvars" value="path=objects/plane/" />
</object>
<!--> <![endif]-->
</p>
<p>This is achieved by first hiding all objects on the page using a style sheet, then when the dom is ready (javascript defer) the script (which is located in an external file) will get a list of all the objects on the page and replace them with themselves, then disable the stylesheet that hid them way back at the beginning. And conditional comments make sure only IE 6+ sees the scripts. You would embed this after all of your own style sheets in the head section of thlike this:</p>
<pre>&lt;!--[if IE gte 6]&gt;<br />&lt;style type=&quot;text/css&quot; id=&quot;ObjectPatentMagic&quot;&gt;object{display:none}&lt;/style&gt;<br />&lt;script type=&quot;text/javascript&quot; src=&quot;ObjectPatentMagic.js&quot; defer=&quot;defer&quot;&gt;&lt;/script&gt;<br />&lt;![endif]--&gt;</pre>
<p>Here is the <a href="ObjectPatentMagic.js">javascript source</a> and here is a <a href="ObjectPatentMagic-p.js">packed version</a> for absolute minimum impact on page load time.</p>
</body>
</html>
